<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Game JSON Editor</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen p-6">
  <h1 class="text-3xl font-bold mb-6 text-center">Game JSON Editor</h1>

  <!-- Add Entry Section -->
  <div class="max-w-5xl mx-auto bg-gray-800 p-4 rounded-xl shadow mb-6">
    <div class="flex flex-wrap gap-3 mb-3">
      <input id="urlInput" type="text" placeholder="Game URL" class="flex-1 min-w-[200px] p-2 rounded bg-gray-700 border border-gray-600">
      <input id="nameInput" type="text" placeholder="Game Name" class="flex-1 min-w-[150px] p-2 rounded bg-gray-700 border border-gray-600">
      <input id="imageInput" type="text" placeholder="Image URL" class="flex-1 min-w-[200px] p-2 rounded bg-gray-700 border border-gray-600">
      <button onclick="addFromInputs()" class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded">Add Entry</button>
    </div>
    <div class="flex gap-3">
      <input type="file" id="fileInput" accept=".json" class="hidden">
      <button onclick="importJSON()" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">Import JSON</button>
      <button onclick="exportJSON()" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded">Export JSON</button>
      <button onclick="clearAll()" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">Clear All</button>
    </div>
  </div>

  <!-- Game Grid -->
  <div id="editor" class="max-w-5xl mx-auto grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3"></div>

  <script>
    let data = JSON.parse(localStorage.getItem('games-json') || '[]');
    const editor = document.getElementById('editor');

    function save() {
      localStorage.setItem('games-json', JSON.stringify(data, null, 2));
      render();
    }

    function render() {
      editor.innerHTML = '';
      data.forEach((entry, index) => {
        const card = document.createElement('div');
        card.className = "bg-gray-800 rounded-xl p-4 shadow-lg flex flex-col";
        card.innerHTML = `
          <img src="${entry.image}" alt="preview" class="w-full h-40 object-cover rounded mb-3 border border-gray-700" onerror="this.src='https://via.placeholder.com/300x150?text=No+Image'">
          <input type="text" value="${entry.name}" placeholder="Name" class="bg-gray-700 rounded p-2 mb-2 w-full" onchange="updateField(${index}, 'name', this.value)">
          <input type="text" value="${entry.url}" placeholder="URL" class="bg-gray-700 rounded p-2 mb-2 w-full" onchange="updateField(${index}, 'url', this.value)">
          <input type="text" value="${entry.image}" placeholder="Image URL" class="bg-gray-700 rounded p-2 mb-2 w-full" onchange="updateField(${index}, 'image', this.value)">
          <div class="flex justify-between mt-auto">
            <a href="${entry.url}" target="_blank" class="bg-blue-600 hover:bg-blue-700 px-3 py-1 rounded text-sm">Open</a>
            <button onclick="deleteEntry(${index})" class="bg-red-600 hover:bg-red-700 px-3 py-1 rounded text-sm">Delete</button>
          </div>
        `;
        editor.appendChild(card);
      });
    }

    function updateField(index, key, value) {
      data[index][key] = value;
      save();
    }

    function addFromInputs() {
      const url = document.getElementById('urlInput').value.trim();
      const name = document.getElementById('nameInput').value.trim();
      const image = document.getElementById('imageInput').value.trim();

      if (!url || !name) {
        alert("Please enter at least a name and URL.");
        return;
      }

      data.push({ url, name, image });
      save();

      // Clear inputs
      document.getElementById('urlInput').value = '';
      document.getElementById('nameInput').value = '';
      document.getElementById('imageInput').value = '';
    }

    function deleteEntry(index) {
      if (confirm("Delete this entry?")) {
        data.splice(index, 1);
        save();
      }
    }

    function clearAll() {
      if (confirm("Clear all entries?")) {
        data = [];
        save();
      }
    }

    function exportJSON() {
      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'games.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    function importJSON() {
      const input = document.getElementById('fileInput');
      input.click();
      input.onchange = (event) => {
        const file = event.target.files[0];
        const reader = new FileReader();
        reader.onload = e => {
          try {
            data = JSON.parse(e.target.result);
            save();
          } catch {
            alert('Invalid JSON file');
          }
        };
        reader.readAsText(file);
      };
    }

    render();
  </script>
</body>
</html>
